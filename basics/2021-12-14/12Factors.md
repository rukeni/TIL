# 12-factors

### 12-Factors란?

 클라우드 사용할 때 올바르게 동작하기 위한 12가지 규칙

### 1. 코드 베이스는 1개여야 한다.

- 어플리케이션은 Git, SVN 등으로 소스 관리되어야 하며 1개의 베이스로 운영/개발하여 배포되어야 한다.
- 중요도 : 필수

### 2. 의존성은 명시적으로 선언한다.å

- gemfile, npm 등을 사용하여 준수
- 중요도 : 높음

### 3. 모든 설정 정보는 코드로부터 분리된 공간에 저장되어야 하고 런타임에서 코드에 의해 읽혀야 한다.

- 백업 서비스를 처리하는 리소스, 인증 정보, 배포마다 달라지는 값(cononical hostname), 배포 단계마다 달라 질 수 있는 어떤 값들
- 설정 정보를 저장하면 안되는 곳
    - 코드
    - properties 파일
    - build
    - app server
- 배포 환경용 설정파일을 작성
- 중요도 : 중간

### 4. 연결된 서비스는 코드 수정 없이 전환이 가능해야 한다.

- 백엔드 서비스
    - 네트워크를 이용하는 모든 서비스
    - DB, Cache, SMTP, Messaging/Queueing system
- 중요도 : 높음

### 5. Build, Release, Run

- 코드 베이스는 build → release → run의 단계를 거쳐 배포로 변환되며 각 단계는 엄격하게 분리되어야 한다.
    - 빌드 단계는 개발자, 배포 단계는 배포툴, 실행 단계는 프로세스 매니저에 의해 시작
- 중요도: 구상해볼만 함

### 6. 각 프로세스는 stateless로 아무것도 공유하지 않아야 한다.

- 메모리/파일을 사용할 경우 단일 트랜잭션 내에서 읽고, 쓰고 등의 모든 작업을 처리
- 세션 상태 데이터의 경우 Memcached 또는 Redis와 같은 데이터 저장소에 저장
- 중요도 : 높음

### 7. 배포된 어플리케이션을 접근할 수 있도록 포트 바인딩을 통해 서비스를 공개한다.

- 의존성에 웹서버 라이브러리를 추가해서 구현

### 8. 앱은 수평적으로 확장할 수 있어야 하고 그로인해 동시성을 높일 수 있다.

- 프로세스가 데몬형태가 아니어야 함
- OS 프로세스 관리자/분산 프로세스 관리자/Foreman 같은 툴에 의존해서 output stream을 관리하고, 충돌이 발생한 프로세스에 대응, 재시작과 종료를 처리해야 한다.
- 중요도 : 낮음

### 9. 프로세스는 shut down 신호를 받았을 때 graceful shut down 해야한다.

- Disposability를 준수함으로써 안정성을 얻을 수 있다.
- 중요도 : 중간

### 10. 개발환경, 스테이징 환경, 프로덕션 환경은 최대한 비슷하게 유지한다.

- 시간의 차이를 최소화하여 개발자가 작성한 코드는 몇 시간안에 배포되어야 한다.
- 담당자의 차이를 최소화 하여 코드를 작성한 개발자가 프로덕션에서도 모니터링에 관여한다.
- 중요도 : 중간

### 11. 로그를 이벤트 스트림으로 취급하여 로그를 로컬에 저장하지 않는다.

- SaaS는 언제든지 인스턴스가 생성/삭제 될 수 있으므로 로컬에 로그는 초기화 됨
- 스트림으로 취급하여 별도로 저장소에 보관해야 한다.
- 중요도 : 낮음

### 12. admin/maintenance 작업은 일회성 프로세스로 실행해야 한다.

- 관리 및 유지보수 작업은 release와 함께 실행
- release와 동일한 환경에서 실행하고 같은 코드 베이스와 config를 사용
- admin 코드는 동기화 문제를 피하기 위해 어플리케이션 코드와 함께 배포
- 중요도 : 높음