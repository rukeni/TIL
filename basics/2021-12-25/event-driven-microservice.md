# Event Driven Micro Service

### Event Driven 이란?

 Event Driven은 IT 영역에서 아주 오래된 키워드이다. 또한 현재도 그 영향력은 대단해서 2018년 가트너에서 선정한 유망한 기술 트렌드 중 하나로 뽑히기도 했다. Event Driven 은 programming, Architecture 등과 연결되어 다양한 정의로 표현된다.

- 컴퓨터 회로를 구동시키기 위해 발생하는 일 - 마우스 클릭, 키보드 타이핑, 모바일 터치 등
- 특정 해동이 자동으로/순서에 따라 발생하는 것이 아닌 어떤 일에 대한 반응으로 동작하는 디자인 패턴
- IOT 기기 등의 센서로부터 유입되는 데이터 스트리밍 기반의 동작
- 시스템 내 외부에 발생한 주목할 만한 상태의 변화에 기반한 동작

Event Driven 은 종종 분산 처리 시스템과 연결되어 언급된다. 분산 처리 시스템에 Event Driven을 엮어 느슨한 결합을 지원하고 유연성, 탄력성, 확장성있는 시스템을 구현할 수 있다.

### Event Driven MicroService란?

Event Driven MicroService(EDM)는 MSA가 적용된 시스템에서 이벤트 발생시 해당 이벤트 로그를 보관하고 이를 기반으로 동작하며, 비동기 통신을 통해 시스템 내 통합을 수행하는 아키텍처이다.

- 이벤트
    - IT 영역에서 이벤트는 다양한 정의를 갖지만 이 곳에서 언급하는 이벤트는 상태의 변경. 즉, 데이터의 변경, 생성, 삭제를 통해 발생하는 서비스의 의미있는 변화를 뜻한다.
- 이벤트 로그를 보관
    - 현재의 데이터는 상태 변경의 누적이라는 생각에서 시작한다. 이 때 상태 변경은 이벤트를 뜻하고 이를 누적하는 행위는 이벤트 로그를 보관하는 것이다. EDM에서 생성된 이벤트는 반드시 보관되어야 한다. 보관된 이벤트는 데이터의 현재 상태를 구성하는 근간이 된다. 또한, 보관된 이벤트를 바탕으로 장애 발생 또는 특정 요구사항에 따라 지정된 시점으로 복원을 수행한다. 이벤트 로그를 보관하는 장소를 이벤트 스토어라 칭한다.
- 비동기 통신
    - amqp, mqtt, jms 등 메시징 프로토콜을 통한 메시지 큐 방식이 자주 사용된다. 서비스에서 데이터의 생성, 변경, 삭제를 통해 이벤트가 발생하면 발행 서비스는 메시지의 형태로 이벤트를 발행하고 해당 이벤트에 관심이 있는 서비스에서 구독을 수행한다. 메시지 큐를 사용함으로써 requeue/dlq 등의 기능을 활용할 수 있다.
- 시스템 내 통합
    - 이상적으로 구현된 MSA는 서비스 간 데이터 참조를 위한 내부 통신이 필요없지만, 현실적으로 서비스 간 내부 통신이 전혀 없는 시스템을 구현하기란 불가능에 가깝다. 다양한 사유로 여러 서비스 간 통신을 통해 연동이 발생한다.

### 사용사례

- RDB + RabbitMQ
- Kafka + KSQL
- Reactive + NoSQL
- Serverless