# 읽기 좋은 코드가 좋은 코드다

## 이해하기 쉬워야한다

`이해하기 쉬워야한다`만큼 모든 개발자가 동의하지만 모호한 개념이 없다.
이해하기 쉽다라는 말을 달성하기 위해서는 무엇이 필요할까?

> 코드는 다른 사람이 그것을 이해하는데 들이는 시간을 최소화하는 방식으로 작성되어야 한다.
> (가독성의 기본 정리)

이말은 코드 작성은 나의 생각을 표현함에 국한되지 않고 다른사람이 어떻게 읽을지가 중요하다.

나는 이 상황을 만족하는 문장은 다음과 같다고 생각한다.

`속해있는 커뮤니티 대부분의 개발자에게는 친숙하면서도 그안에서 가장 간결한 방법`

예전에 프리랜서 하면서 SI를 잠시 경험한적이 있었다.

그곳에서 코드는 내가 알던 코드 규격과는 좀 차이가 있었다.

가령 주소를 address라고 사용하지않고 juso라고 사용하였다.

이런게 가능한 이유는 SI의 커뮤니티에서는 그 바깥세계로 나가는 경우가 적었고

그들만의 규칙의 익숙함이 있었다. 즉, address보다 juso라고 쓰는게 이미 관례였던 것이었다.(심지어 신규 프로젝트도 이러한 관습이 그대로 적용된다.)

물론, 내가 경험했던 부분은 SI의 일부분이었지만 다른 SI회사에서 경험하신 분들도 비슷한 이야기를 하는 것은 어느정도 그들만의 규칙이 있지 않을까 추측하게 한다.

내가 `속해있는 커뮤니티 대부분의 개발자에게는 친숙하면서도 그안에서 가장 간결한 방법`이라는 문장으로 이해하기 쉬운 코드를 표현한 것은 분명 속해있는 커뮤니티마다 조금씩 최선의 코드가 달랐음을 느꼈기 때문이다.

대부분 개발자가 따르고 있는 원칙과 규범이 존재하지만 그게 모든 커뮤니티에서 동일하게 적용되지 않음을 알 것이다. 대세가 있기는 하지만 그 또한 커뮤니티의 여론이 동의하는 맥락이 달라진다면, 대세도 바뀌기 마련이다.

`이해하기 쉬운 코드`라는 말이 거시적인 방향성만 보자면 대동소이하게 모두가 동의하는, 보편적 흐름으로 흐르는 것 같지만 디테일하게 보자면 그 또한 커뮤니티에 의해 유동적임을 잊어서는 안될 것 같다.

이 책을 읽음으로서 거시적인 방향성을 잡게 될 수 있고 디테일하게 적용하는 것은 자신이 속해있는 커뮤니티와 환경에 적합하게 원칙을 스스로가 구체화하여야 할 것이다.

### 이름에 정보를 담아내라

- 특정한 단어 고르기
- 보편적인 이름 피하기 (혹은 언제 그런 이름을 사용해야 하는지 깨닫기)
- 추상적인 이름 대신 구체적인 이름 사용하기
- 접두사 혹은 접미사로 이름에 추가적인 정보 덧붙이기
- 이름이 얼마나 길어져도 좋은지 결정하기
- 추가적인 정보를 담을 수 있게 이름 구성하기

이름에 정보를 담으라는 저자의 멘트는 나에게 뜬금없이 **두괄식 글쓰기**를 떠올리게 했다.

두괄식 글쓰기란 `글의 첫부분에 핵심적인 내용, 주장, 주제를 제시한 후에 부연 설명을 하는 방식으로 글을 쓰는 것`이라고 표현할 수 있다.

즉 함수를 글이라고 생각해보면, 함수이름은 핵심적인 내용이고 안에 로직은 그 핵심적인 내용을 서술하는 부연 설명이라고 해석이 되었다.

대표적인 주장(함수 이름)만 보고 안에 로직(부연설명)을 파악할 수 있게끔하는게 네이밍을 잘 짓는 것과 일맥상통하는 부분이 있다고 느꼈다.

## 본인이 지은 이름을 "다른 사람들이 다른 의미로 해석할 수 있을까?"라는 질문을 던져보며 철저하게 확인해야 한다

이 관점은 개발의 영역이라기보단 공감에 영역 혹은 경험의 영역이라고 본다. 100번 생각해도 다른사람의 관점을 잘 파악하지 못하는 사람도 있다고 생각한다. 아예 경험이 없거나 공감능력이 떨어진다면 이와 같은 질문을 던져도 어떻게 해야할지 몰라하는게 태반이라고 생각이 든다.

나는 이럴때는, 관행의 힘을 빌려보면 좋을 것 같다.

가장 손쉽게 관행을 파악할 수 있는 방법은 github이다. github은 다양한 방식으로 검색이 가능한데 내가 쓰고자 하는 변수명이 일반적으로 사용되는 이름인지 검색해볼 수 있다. 아쉽게도 github에서 찾을 수 없는 특수한 도메인과 관련이 되어있다면, 부딪히면서 배우는 수밖에 없다는 생각이 든다.

## 일관성과 간결성을 위해서 줄 바꿈을 재정렬하기

> 코드를 '보기 예쁘게' 만드는 작업은 표면적인 개선 이상의 결과를 가져온다.

미학적 개선의 의도치 않은 장점

- 중복된 코드를 없애서 더 간결하게
- 이름이나 에러 문자열 같은 테스트의 중요 부분들이 한 눈에 보이게
- 새로운 테스트 추가가 훨씬 쉬워짐

### 코드를 '문단'으로 쪼개라

일반 텍스트가 여러 개의 문단으로 나뉘어진 데에는 이유가 있다.

- 비슷한 생각을 하나로 묶어서, 성격이 다른 생각과 구분한다.
- 문단은 '시각적 디딤돌' 역할을 수행한다. 문단이 없으면 하나의 페이지 안에서 읽던 부분을 놓치기 쉽다.
- 하나의 문단에서 다른 문단으로의 전진을 촉진시킨다.

### 요약

- 여러 블록에 담긴 코드가 모두 비슷한 일을 수행하면, 실루엣이 동일해 보이게 만들어라.
- 코드 곳곳을 '열'로 만들어서 줄을 맞추면 코드를 한 눈에 훑어보기 편하다.
- 코드의 한 곳에서 A, B, C가 이 순서대로 언급되고 있으면, 다른 곳에서 B, C, A와 같은 식으로 언급하지 마라. 의미 있는 순서를 정하여 모든 곳에서 그 순서를 지켜라.
- 빈 줄을 이용하여 커다란 블록을 논리적인 '문단'으로 나누어라.

## 주석의 목적은 코드를 읽는 사람이 코드를 작성한 사람만큼 코드를 잘 이해하게 돕는 데 있다

주석에 관련한 흥미로운 측면을 설명함

- 설명하지 말아야 하는 것
- 코딩을 수행하면서 머릿속에 있는 정보를 기록하기
- 코드를 읽는 사람의 입장에서 필요한 정보가 무엇인지 유추하기

-> Question: 주석은 코드를 최대한 이해하기 쉽게 작성했지만 그것만으로는 설명이 부족할 때 작성하는 측면인 건가?

### 설명자체를 위한 설명을 달지 말라

함수의 선언과 주석 내용이 실질적으로 일치하는 경우다.
이러한 주석은 무가치한 주석에 범주에 속하고 지우거나 개선해야 한다.

### 나쁜 이름에 주석을 달지 마라

이름에 어떤 의도를 내포하고 있는데 그걸 못알아들을것 같아서 주석을 단다.
그러지 말고 이름자체를 좋은 이름으로 바꾸어라.

## 생각을 기록하라

설명하지 말아야할 것은 보았으니 해야할 것은 무엇인지 알아보자.

좋은 주석은 단순히 '자신의 생각을 기록하는 것'만으로도 탄생할 수 있다. 즉, 코딩할때 생각했던 중요한 생각을 기록하면 된다.

### '감독의 설명'을 포함하라

종종 영화에는 자신의 통찰을 설명하고 영화가 만들어진 과정을 관람객이 잘 이해하게 도와주는 '감독의 설명'을 담은 트랙이 있다. 이와 비슷하게 중요한 통찰은 주석을 통해서 코드에 포함시켜야 한다.

### 코드의 결함을 설명하라

코드는 지속적으로 진화하며 그러는 과정 중에 버그를 갖게 될 수밖에 없다. 이러한 결함을 설명하는 것을 부끄러워할 필요는 없다.

### 상수에 대한 설명

상수를 정의할 때는 종종 그 상수가 무엇을 하는지, 그것이 왜 특정한 값을 갖게 되었는지 '사연'이 존재하기 마련이다. 별도의 설명이 필요하지 않을 것처럼 보이지만, 이러한 상수값을 선택한 사람은 분명히 뭔가 더 많은 사실을 알고 있을 것이다.

상수 값이 신중하게 설정되었으므로 변경하지 않는 게 더 좋은 경우도 있다.

저자의 경험에 따르면 상수에 주석을 붙이면 의미가 더 뚜렷해진다.

### 글 쓰는 두려움을 떨쳐내라

예를 들어, 어느 함수를 작성하는데 "이런 제길, 이 리스트 안에 중복된 항목이 있으면 이건 복잡해지잖아!"라고 생각을 했다면 그냥 그말을 주석으로 작성하라.

## 루프와 논리 단순화

줄 수를 최소화하는 일보다 다른 사람이 코드를 읽고 이해하는 데 걸리는 시간을 최소화하는 일이 더 중요하다.

## 거대한 표현을 더 소화하기 쉬운 여러 조각으로 나눈다

거대한 표현을 소화하기 쉬운 작은 조각으로 나눠야 한다.

- 쇼트 서킷 논리 오용하지 않기

## 한번에 하나만 수행하도록 코드를 구성하기

- 과도한 작업을 피한다. 꼭 필요하지 않는 기능을 제거한다.
- 요구사항을 다시 생각해서 가장 단순한 형태의 문제를 찾아본다.
- 주기적으로 라이브러리 전체 API를 훑어봄으로써 표준 라이브러리에 친숙해진다.

### 자기 주변에 있는 라이브러리에 친숙해져라

라이브러리가 할 수 있는 일을 알고 활용하는 것은 대단히 중요하다.

> 매일 15분씩 자신의 표준 라이브러리에 있는 모든 함수/모듈/형들의 이름을 읽어라.

## 다른 프로그래머가 수정하거나 새로운 테스트를 더하는 걸 쉽게 느낄 수 있게 테스트 코드는 읽기 쉬워야 한다

테스트 코드가 크고 두렵게 느껴지면 다음과 같은 일이 일어난다.

- 코드를 수정하는 일이 두려워진다. 아니, 우리는 이 코드에 손대고 싶지 않아. 테스트 케이스를 모두 변경하는 일은 너무나 끔찍하다고!
- 새로운 코드를 작성하면 그에 따르는 새로운 테스트를 작성하지 않는다. 시간이 흐름이 지나면서 더 낮은 비율의 코드가 테스트되며, 따라서 코드에 대한 확신이 줄어들 수밖에 없다.

### 테스트를 더 읽기 쉽게 만들기

일반적인 설계원리를 따르면 덜 중요한 세부 사항은 사용자가 볼 필요 없게 숨겨서 더 중요한 내용이 눈에 잘 띄게 해야 한다.

### 지나친 테스트

- 테스트를 가능하게 하려고 실제 코드의 가독성을 희생시킨다.
- 실제 코드 테스트를 가능하게 하는 것은 반드시 윈-윈 상황이 되어야 한다.
- 100% 코드 테스트에 집착하는 일. 코드의 90%를 테스트하는 노력이 종종 나머지 10%를 테스트하는 비용보다 적은 노력이 들기도 한다.
- 사실 코드를 100% 테스트하는 일은 일어나지 않는다. 테스트되지 않은 버그가 있을 수도 있고 테스트되지 않은 기능이 있을 수도 있으며, 요구사항이 달라졌다는 사실을 모르고 있을 수도 있기 때문이다.
- 버그가 야기하는 비용이 어느 정도인지에 따라서, 테스트 코드를 작성하는 시간이 의미를 갖는 부분이 있고 그렇지 않은 부분도 있기 마련이다.
  - 만약 웹사이트의 프로토타입을 만든다면, 테스트 코드 작성건은 전혀 의미가 없다.
- 테스트 코드로 실제 제품 개발이 차질을 빚게 되는 일. 단지 일부분에 불과한 테스트가 프로젝트 전체를 지배하는 경우를 본 적이 있다. 테스트가 숭배되어야 하는 신의 자리를 차지하고 프로그래머들은 자신의 시간이 다른 일에 쓰이는 것이 더 낫다는 사실을 망각한 채 자신을 위한 의식과 동작에 몰두한다.

### 테스트를 개선하기 위한 구체적인 노력

- 각 테스트의 최상위수준은 최대한 간결해야 한다. 이상적으로는 각 테스트의 입출력이 한줄의 코드로 설명될 수 있어야 한다.
- 테스트에 실패하면 버그를 추적해서 수정하는 데 도움이 될 만한 에러 메시지를 출력해야 한다.
- 코드의 구석구석을 철저하게 실행하는 가장 간단한 입력을 사용하라
- 무엇이 테스트되는지 분명하게 드러나도록 테스트 함수에 충분한 설명이 포함된 이름을 부여하라.
